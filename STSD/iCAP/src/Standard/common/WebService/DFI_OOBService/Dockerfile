# Web Service Dockerfile
From node

MAINTAINER Docker Innodisk

RUN npm install pm2 -g
# Create app directory

ADD . /app/OOBService
ENV DEBUG=1
ENV TEST=1
ENV SERVICE_PORT=8165
ENV SQL_HOST=172.30.0.3
ENV SQL_PORT=3389
ENV SQL_DB=icap
ENV SQL_USER=root
ENV SQL_PASSWORD=admin
ENV MQTT_HOST=mqtt://172.30.0.101
ENV MQTT_PORT=18883
ENV MQTT_PASSWORD=B673AEBC6D65E7F42CFABFC7E01C02D0
ENV MQTT_USERNAME=innoage
ENV REDIS_HOST=172.30.0.5
ENV REDIS_PORT=6379
ENV INNOAGE_SERVICE_HOST=172.30.0.100:8161
ENV AUTHENTICATION_HOST=172.30.0.6:50000

WORKDIR /app/OOBService

RUN npm install
RUN npm run build

ENTRYPOINT ["npm","run"]
CMD ["prodMod"]

# EXPOSE 8165
